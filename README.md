# credit-score-web-pentest
Vulnerable credit score web app

PASO 1 - XSS

Le hacemos llegar a la víctima un correo electrónico phishing que contiene un link a una página web maliciosa, la cual dentro del código HTML tiene código JavaScript que roba las cookies de sesión de la aplicación web vulnerable (financiera). 
Cuando la víctima ingresa a la página web maliciosa, se ejecuta dicho código y se crea un archivo .txt en el servidor de la página web maliciosa llamado “stolen_cookies.txt” que contiene las cookies robadas.
Esto es posible ya que no se siguen prácticas recomendadas, como por ejemplo: escapar datos de salida antes de mostrarlos en HTML y usar cabeceras de seguridad de HTTP como CSP (content security policy).
SUPUESTO: la víctima debe estar logueada en la página web vulnerable (financiera) antes de ingresar a la página web maliciosa.

PASO 2 - Identification and authentication failures

Una vez que tenemos las cookies de sesión, abrimos una ventana en el navegador web e ingresamos a la cuenta de la víctima en la aplicación web vulnerable (financiera) haciendo uso de las cookies robadas.
Esto es posible ya que no se utilizan flags de seguridad al configurar las cookies, como por ejemplo: HttpOnly, Secure y SameSite.

PASO 3 - SQL Injection

Una vez dentro de la cuenta de la víctima, nuestro objetivo es escalar privilegios y convertirnos en administradores. Para eso, buscamos algún punto de entrada.
Nos dirigimos al apartado para modificar la información personal del usuario y probamos algunos inputs en el campo “Nombre”.

Primero probamos ingresando el carácter ‘. Vemos que se ocasiona un error que revela cierta información sensible como el tipo de la base de datos y el nombre de la tabla “usuarios”.
Luego, con esta información, probamos ingresando la sentencia Steven'; SELECT * FROM usuarios; -- . Vemos que se ocasiona otro error que revela mas información sensible, como por ejemplo, el valor del campo “es_admin”, el cual esta en 0.
Por ultimo, probamos ingresando la sentencia Steven', es_admin = 1 WHERE username = 'steven' -- " . Vemos que se genera un error de sintaxis, pero al volver al dashboard principal, ahora nos aparece el dashboard de los administradores. Hemos podido escalar privilegios.

Esto es posible ya que no se están utilizando buenas prácticas, como por ejemplo: uso de sentencias SQL preparadas, validación y sanitización de todas las entradas del usuario en el servidor, manejo de errores adecuado y evitar la construcción de consultas SQL concatenando cadenas.
